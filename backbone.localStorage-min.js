function S4(){return(((1+Math.random())*65536)|0).toString(16).substring(1)}function guid(){return(S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4())}Storage.prototype.setObject=function(a,b){this.setItem(a,JSON.stringify(b))};Storage.prototype.getObject=function(a){return this.getItem(a)&&JSON.parse(this.getItem(a))};var Store=function(a){this.name=a};_.extend(Store.prototype,{create:function(a){this.data=localStorage.getObject(this.name);if(!this.data){this.data=[]}if(!a.id){a.attributes.id=guid()}this.data.push(a);localStorage.setObject(this.name,this.data);return{model:a,status:"success"}},update:function(a){var b=[];var c=false;this.data=localStorage.getObject(this.name);if(!this.data){this.data=[]}b=_.map(this.data,function(d){if(d.id==a.id){c=true;return a}else{return d}});if(!c){this.create(a)}else{localStorage.setObject(this.name,b)}return{model:a,status:"success"}},find:function(b){var a;this.data=localStorage.getObject(this.name);if(!this.data){this.data=[]}_.each(this.data,function(c){if(c.id==b.id){a=c;_.breakLoop()}});if(typeof(a)=="object"){return{model:a,status:"success"}}else{return{error:"Record Not Found.",status:"error"}}},findAll:function(){this.data=localStorage.getObject(this.name);if(!this.data){this.data=[]}return{models:this.data,status:"success"}},destroy:function(a){var b=[];var d;var c=false;this.data=localStorage.getObject(this.name);if(!this.data){this.data=[]}_.each(this.data,function(f,e){if(f.id==a.id){c=true;d=e;_.breakLoop()}});if(c){this.data.splice(d,1)}localStorage.setObject(this.name,this.data);if(c){return{model:a,status:"success"}}else{return{error:"Record Not Found.",status:"error"}}}});Backbone.sync=function(f,c,e,b){var d;var a=c.localStore?c.localStore:c.collection.localStore;if(f==="read"){d=c.id?a.find(c):a.findAll()}else{if(f==="create"){d=a.create(c)}else{if(f==="update"){d=a.update(c)}else{if(f==="delete"){d=a.destroy(c)}}}}if(d.status=="success"){e(d)}else{if(d.status=="error"&&b){b(d)}}};